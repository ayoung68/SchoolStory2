#Forecast/Predict Annual Visitors to Washington Monument NP (since 1936)

# Data
# create a dataframe called washington
#»Washington Monument NP, (annual visitors since 1936)
#Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)
# retrieved on Thu Jan 18 2018

washington <- read.csv(header = TRUE, text ='
                      Year,RecreationVisitors,TotalRecreationVisitors
                       1936,"857,441","81,365,896"
                       1937,"998,686","81,365,896"
                       1938,"832,439","81,365,896"
                       1939,"927,543","81,365,896"
                       1940,"959,624","81,365,896"
                       1941,"965,689","81,365,896"
                       1942,"499,734","81,365,896"
                       1943,"472,004","81,365,896"
                       1944,"550,991","81,365,896"
                       1945,"608,667","81,365,896"
                       1946,"846,249","81,365,896"
                       1947,"794,813","81,365,896"
                       1948,"805,231","81,365,896"
                       1949,"867,327","81,365,896"
                       1950,"906,661","81,365,896"
                       1951,"962,000","81,365,896"
                       1952,"985,391","81,365,896"
                       1953,"1,022,269","81,365,896"
                       1954,"1,010,400","81,365,896"
                       1955,"1,039,900","81,365,896"
                       1956,"1,013,400","81,365,896"
                       1957,"1,143,100","81,365,896"
                       1958,"1,031,500","81,365,896"
                       1959,"1,186,000","81,365,896"
                       1960,"1,392,900","81,365,896"
                       1961,"1,592,300","81,365,896"
                       1962,"1,758,300","81,365,896"
                       1963,"1,750,200","81,365,896"
                       1964,"1,893,600","81,365,896"
                       1965,"1,986,100","81,365,896"
                       1966,"2,059,300","81,365,896"
                       1967,"1,905,200","81,365,896"
                       1968,"1,607,800","81,365,896"
                       1969,"1,658,500","81,365,896"
                       1970,"1,541,600","81,365,896"
                       1971,"1,518,500","81,365,896"
                       1972,"1,613,482","81,365,896"
                       1973,"1,446,500","81,365,896"
                       1974,"1,436,200","81,365,896"
                       1975,"1,064,500","81,365,896"
                       1976,"1,385,100","81,365,896"
                       1977,"1,230,900","81,365,896"
                       1978,"1,451,336","81,365,896"
                       1979,"1,304,790","81,365,896"
                       1980,"1,305,760","81,365,896"
                       1981,"1,359,061","81,365,896"
                       1982,"1,292,284","81,365,896"
                       1983,"1,212,736","81,365,896"
                       1984,"1,342,093","81,365,896"
                       1985,"1,229,062","81,365,896"
                       1986,"1,271,214","81,365,896"
                       1987,"1,300,983","81,365,896"
                       1988,"1,218,031","81,365,896"
                       1989,"1,136,662","81,365,896"
                       1990,"1,245,479","81,365,896"
                       1991,"1,168,736","81,365,896"
                       1992,"1,165,160","81,365,896"
                       1993,"1,080,030","81,365,896"
                       1994,"1,000,278","81,365,896"
                       1995,"943,098","81,365,896"
                       1996,"707,498","81,365,896"
                       1997,"841,218","81,365,896"
                       1998,"340,190","81,365,896"
                       1999,"553,420","81,365,896"
                       2000,"185,085","81,365,896"
                       2001,0,"81,365,896"
                       2002,"454,768","81,365,896"
                       2003,"529,985","81,365,896"
                       2004,"378,416","81,365,896"
                       2005,"467,550","81,365,896"
                       2006,"586,603","81,365,896"
                       2007,"591,081","81,365,896"
                       2008,"671,031","81,365,896"
                       2009,"676,002","81,365,896"
                       2010,"628,665","81,365,896"
                       2011,"430,153","81,365,896"
                       2012,0,"81,365,896"
                       2013,0,"81,365,896"
                       2014,"423,170","81,365,896"
                       2015,"493,550","81,365,896"
                       2016,"252,677","81,365,896"
                      ')

# remove the commas from the numbers
washington$RecreationVisitors<-as.numeric(gsub(',','',washington$RecreationVisitors))
mean(washington$RecreationVisitors)
                       
#change to "Visitors (in millions)"
washington$RecreationVisitors<-washington$RecreationVisitors/10^6

#EDA

# plot time series
plot(RecreationVisitors~Year, data = washington, type='b',
     ylab = "Washington Monument NP Annual Visitors (in millions)")
    tail(washington)
    
#One feature of the time series that violates the ARIMA model is additivity. Because the data is not linear,
#it is also not additive. This is evident because of the spikes in the data during World War II, and since
#the year 2000. This is likely true because without a log transformation  of the data, there is 
#strong influence from the outliers.    

#Forecast/Predict Annual Visitors to Jefferson Memorial NP (since 1941)

#Data
#create a dataframe called jefferson
#»Jefferson Memorial NP, (annual visitors since 1941)
    #Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)
    # retrieved on Thu Jan 18 2018
    
                           
jefferson <- read.csv(header = TRUE, text = '
                      Year,RecreationVisitors,TotalRecreationVisitors
                      1941,0,"134,831,931"
                      1942,"12,154","134,831,931"
                      1943,"34,149","134,831,931"
                      1944,"31,025","134,831,931"
                      1945,"35,899","134,831,931"
                      1946,"29,109","134,831,931"
                      1947,"24,485","134,831,931"
                      1948,"28,903","134,831,931"
                      1949,"24,923","134,831,931"
                      1950,"27,051","134,831,931"
                      1951,"22,719","134,831,931"
                      1952,"21,674","134,831,931"
                      1953,"26,124","134,831,931"
                      1954,"23,700","134,831,931"
                      1955,"28,500","134,831,931"
                      1956,"36,300","134,831,931"
                      1957,"30,000","134,831,931"
                      1958,"31,900","134,831,931"
                      1959,"29,800","134,831,931"
                      1960,"48,500","134,831,931"
                      1961,"63,600","134,831,931"
                      1962,"94,100","134,831,931"
                      1963,"250,000","134,831,931"
                      1964,"282,700","134,831,931"
                      1965,"3,013,800","134,831,931"
                      1966,"4,616,000","134,831,931"
                      1967,"2,134,900","134,831,931"
                      1968,"2,019,800","134,831,931"
                      1969,"1,993,800","134,831,931"
                      1970,"1,388,600","134,831,931"
                      1971,"1,412,400","134,831,931"
                      1972,"2,495,951","134,831,931"
                      1973,"3,056,600","134,831,931"
                      1974,"2,197,200","134,831,931"
                      1975,"2,191,000","134,831,931"
                      1976,"3,337,700","134,831,931"
                      1977,"3,490,600","134,831,931"
                      1978,"2,654,768","134,831,931"
                      1979,"1,859,431","134,831,931"
                      1980,"1,928,825","134,831,931"
                      1981,"2,282,261","134,831,931"
                      1982,"2,967,323","134,831,931"
                      1983,"2,948,022","134,831,931"
                      1984,"1,709,993","134,831,931"
                      1985,"2,140,316","134,831,931"
                      1986,"2,311,147","134,831,931"
                      1987,"2,364,694","134,831,931"
                      1988,"2,477,458","134,831,931"
                      1989,"2,518,712","134,831,931"
                      1990,"2,382,612","134,831,931"
                      1991,"2,622,425","134,831,931"
                      1992,"2,415,514","134,831,931"
                      1993,"2,539,740","134,831,931"
                      1994,"2,553,696","134,831,931"
                      1995,"3,234,977","134,831,931"
                      1996,"3,649,308","134,831,931"
                      1997,"3,420,076","134,831,931"
                      1998,"3,420,352","134,831,931"
                      1999,"3,481,042","134,831,931"
                      2000,"3,458,956","134,831,931"
                      2001,"3,532,524","134,831,931"
                      2002,"3,333,454","134,831,931"
                      2003,"2,685,219","134,831,931"
                      2004,"2,779,350","134,831,931"
                      2005,"2,944,976","134,831,931"
                      2006,"2,572,072","134,831,931"
                      2007,"2,385,387","134,831,931"
                      2008,"1,954,810","134,831,931"
                      2009,"2,360,109","134,831,931"
                      2010,"2,436,110","134,831,931"
                      2011,"2,259,020","134,831,931"
                      2012,"2,496,726","134,831,931"
                      2013,"2,377,258","134,831,931"
                      2014,"1,817,091","134,831,931"
                      2015,"1,698,656","134,831,931"
                      2016,"1,271,855","134,831,931"
                      ')
# remove the commas from the numbers
jefferson$RecreationVisitors<-as.numeric(gsub(',','',jefferson$RecreationVisitors))
mean(jefferson$RecreationVisitors)

#change to "Visitors (in millions)"
jefferson$RecreationVisitors<-jefferson$RecreationVisitors/10^6

#EDA

# plot time series
plot(RecreationVisitors~Year, data = jefferson, type='b',
     ylab = "Jefferson Memorial NP Annual Visitors (in millions)")
tail(jefferson)

#One significant feature of the time series that violated the ARIMA model was the non-linearity
#of the data, meaning additivity was not achieved. This exists due to a sudden increase in annual
#visitors around the year 1965, when annual visitation increased by ten times. Because of the 
#non-linearity, it is necessary to modify the data in order to proceed with ARIMA testing.

#Forecast/Predict Annual Visitors to Wright Bros Memorial NP (since 1934)

#Data
#create a dataframe called wrightbros
#»Wright Bros Memorial NP, (annual visitors since 1934)
#Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)
# retrieved on Thu Jan 18 2018

wrightbros <- read.csv(header = TRUE, text = '
                      Year,RecreationVisitors,TotalRecreationVisitors
                      1934,"17,010","27,109,570"
                      1935,"28,472","27,109,570"
                      1936,"48,690","27,109,570"
                      1937,"82,188","27,109,570"
                      1938,"80,911","27,109,570"
                      1939,"70,071","27,109,570"
                      1940,"54,729","27,109,570"
                      1941,"86,025","27,109,570"
                      1942,"11,319","27,109,570"
                      1943,"11,054","27,109,570"
                      1944,"8,592","27,109,570"
                      1945,"15,439","27,109,570"
                      1946,"49,512","27,109,570"
                      1947,"77,739","27,109,570"
                      1948,"72,984","27,109,570"
                      1949,"86,327","27,109,570"
                      1950,"111,116","27,109,570"
                      1951,"113,324","27,109,570"
                      1952,"153,072","27,109,570"
                      1953,"184,328","27,109,570"
                      1954,"184,500","27,109,570"
                      1955,"184,600","27,109,570"
                      1956,"305,500","27,109,570"
                      1957,"327,900","27,109,570"
                      1958,"241,100","27,109,570"
                      1959,"197,900","27,109,570"
                      1960,"237,600","27,109,570"
                      1961,"257,100","27,109,570"
                      1962,"223,600","27,109,570"
                      1963,"249,700","27,109,570"
                      1964,"296,800","27,109,570"
                      1965,"302,700","27,109,570"
                      1966,"370,900","27,109,570"
                      1967,"340,000","27,109,570"
                      1968,"310,400","27,109,570"
                      1969,"324,900","27,109,570"
                      1970,"489,400","27,109,570"
                      1971,"392,300","27,109,570"
                      1972,"423,725","27,109,570"
                      1973,"413,600","27,109,570"
                      1974,"472,700","27,109,570"
                      1975,"485,200","27,109,570"
                      1976,"505,000","27,109,570"
                      1977,"535,000","27,109,570"
                      1978,"481,140","27,109,570"
                      1979,"396,322","27,109,570"
                      1980,"428,809","27,109,570"
                      1981,"429,618","27,109,570"
                      1982,"415,360","27,109,570"
                      1983,"484,289","27,109,570"
                      1984,"409,493","27,109,570"
                      1985,"448,677","27,109,570"
                      1986,"630,779","27,109,570"
                      1987,"315,957","27,109,570"
                      1988,"328,617","27,109,570"
                      1989,"472,894","27,109,570"
                      1990,"463,461","27,109,570"
                      1991,"461,494","27,109,570"
                      1992,"477,643","27,109,570"
                      1993,"477,362","27,109,570"
                      1994,"475,755","27,109,570"
                      1995,"434,671","27,109,570"
                      1996,"393,721","27,109,570"
                      1997,"425,132","27,109,570"
                      1998,"419,210","27,109,570"
                      1999,"375,681","27,109,570"
                      2000,"429,472","27,109,570"
                      2001,"438,548","27,109,570"
                      2002,"440,737","27,109,570"
                      2003,"712,181","27,109,570"
                      2004,"421,341","27,109,570"
                      2005,"458,948","27,109,570"
                      2006,"466,144","27,109,570"
                      2007,"494,331","27,109,570"
                      2008,"527,721","27,109,570"
                      2009,"476,291","27,109,570"
                      2010,"476,200","27,109,570"
                      2011,"445,455","27,109,570"
                      2012,"466,816","27,109,570"
                      2013,"447,796","27,109,570"
                      2014,"430,517","27,109,570"
                      2015,"437,184","27,109,570"
                      2016,"458,776","27,109,570"
                      ')

#remove the commas from the numbers
wrightbros$RecreationVisitors<-as.numeric(gsub(',','',wrightbros$RecreationVisitors))
mean(wrightbros$RecreationVisitors)

#change to "Visitors (in millions)"
wrightbros$RecreationVisitors<-wrightbros$RecreationVisitors/10^6

#EDA

# plot time series
plot(RecreationVisitors~Year, data = wrightbros, type='b',
ylab = "Wright Bros Memorial NP Annual Visitors (in millions)")
tail(wrightbros)

#One feature of the time series plot that violates an ARIMA model assumption is the sudden 
#jump in annual visitors to the Wright Bros NP in the year 1986. It happened again in 2003.
#Because it shows a multiplicative effect, this violates the principle of additivity. This may 
#be altered through a log transformation. Filtering to the recent past would not be as impactful 
#since the jumps have come in recent years. 

#Forecast/Predict Annual Visitors to Acadia NP (since 1919)

#Data
#create a dataframe called acadia
#»Acadia NP, (annual visitors since 1919)
#Bookmark this report: https://irma.nps.gov/Stats/SSRSReports/Park%20Specific%20Reports/Annual%20Park%20Recreation%20Visitation%20(1904%20-%20Last%20Calendar%20Year)
# retrieved on Thu Jan 18 2018

acadia <- read.csv(header = TRUE, text = '
                      Year,RecreationVisitors,TotalRecreationVisitors
                      1919,"64,000","163,512,192"
                      1920,"66,500","163,512,192"
                      1921,"69,836","163,512,192"
                      1922,"73,779","163,512,192"
                      1923,"64,200","163,512,192"
                      1924,"71,758","163,512,192"
                      1925,"73,673","163,512,192"
                      1926,"101,256","163,512,192"
                      1927,"123,699","163,512,192"
                      1928,"134,897","163,512,192"
                      1929,"149,554","163,512,192"
                      1930,"154,734","163,512,192"
                      1931,"162,238","163,512,192"
                      1932,"237,596","163,512,192"
                      1933,"262,712","163,512,192"
                      1934,"275,956","163,512,192"
                      1935,"316,114","163,512,192"
                      1936,"340,393","163,512,192"
                      1937,"383,036","163,512,192"
                      1938,"394,319","163,512,192"
                      1939,"396,468","163,512,192"
                      1940,"382,084","163,512,192"
                      1941,"409,961","163,512,192"
                      1942,"36,544","163,512,192"
                      1943,"8,246","163,512,192"
                      1944,"12,916","163,512,192"
                      1945,"20,200","163,512,192"
                      1946,"382,390","163,512,192"
                      1947,"434,069","163,512,192"
                      1948,"420,846","163,512,192"
                      1949,"438,584","163,512,192"
                      1950,"485,220","163,512,192"
                      1951,"518,556","163,512,192"
                      1952,"549,075","163,512,192"
                      1953,"556,195","163,512,192"
                      1954,"553,800","163,512,192"
                      1955,"655,000","163,512,192"
                      1956,"735,500","163,512,192"
                      1957,"858,900","163,512,192"
                      1958,"816,500","163,512,192"
                      1959,"755,900","163,512,192"
                      1960,"1,638,200","163,512,192"
                      1961,"1,574,600","163,512,192"
                      1962,"1,601,500","163,512,192"
                      1963,"1,864,800","163,512,192"
                      1964,"2,011,600","163,512,192"
                      1965,"1,733,600","163,512,192"
                      1966,"2,158,400","163,512,192"
                      1967,"2,102,000","163,512,192"
                      1968,"2,303,300","163,512,192"
                      1969,"2,489,800","163,512,192"
                      1970,"2,776,300","163,512,192"
                      1971,"2,101,100","163,512,192"
                      1972,"2,285,881","163,512,192"
                      1973,"2,394,000","163,512,192"
                      1974,"2,335,800","163,512,192"
                      1975,"2,380,500","163,512,192"
                      1976,"2,353,300","163,512,192"
                      1977,"2,734,600","163,512,192"
                      1978,"2,684,933","163,512,192"
                      1979,"2,787,366","163,512,192"
                      1980,"2,779,666","163,512,192"
                      1981,"2,997,972","163,512,192"
                      1982,"3,572,114","163,512,192"
                      1983,"4,124,639","163,512,192"
                      1984,"3,734,763","163,512,192"
                      1985,"3,745,570","163,512,192"
                      1986,"3,929,054","163,512,192"
                      1987,"4,288,154","163,512,192"
                      1988,"4,502,283","163,512,192"
                      1989,"5,440,952","163,512,192"
                      1990,"2,339,591","163,512,192"
                      1991,"2,475,857","163,512,192"
                      1992,"2,382,113","163,512,192"
                      1993,"2,656,034","163,512,192"
                      1994,"2,710,749","163,512,192"
                      1995,"2,845,378","163,512,192"
                      1996,"2,704,831","163,512,192"
                      1997,"2,760,306","163,512,192"
                      1998,"2,594,497","163,512,192"
                      1999,"2,602,227","163,512,192"
                      2000,"2,469,238","163,512,192"
                      2001,"2,516,551","163,512,192"
                      2002,"2,558,572","163,512,192"
                      2003,"2,431,062","163,512,192"
                      2004,"2,207,847","163,512,192"
                      2005,"2,051,484","163,512,192"
                      2006,"2,083,588","163,512,192"
                      2007,"2,202,228","163,512,192"
                      2008,"2,075,857","163,512,192"
                      2009,"2,227,698","163,512,192"
                      2010,"2,504,208","163,512,192"
                      2011,"2,374,645","163,512,192"
                      2012,"2,431,052","163,512,192"
                      2013,"2,254,922","163,512,192"
                      2014,"2,563,129","163,512,192"
                      2015,"2,811,184","163,512,192"
                      2016,"3,303,393","163,512,192"
                      ')

#remove the commas from the numbers
acadia$RecreationVisitors<-as.numeric(gsub(',','',acadia$RecreationVisitors))
mean(acadia$RecreationVisitors)

#change to "Visitors (in millions)"
acadia$RecreationVisitors<-acadia$RecreationVisitors/10^6

#EDA

# plot time series
plot(RecreationVisitors~Year, data = acadia, type='b',
     ylab = "Acadia NP Annual Visitors (in millions)")
tail(acadia)

#A significant feature that again violates this Arima model is the multiplicative effect, which
#violates the assumption of additivity. This is evident around the year 1990, when the annual visitors
#to the park dropped by more than half from the previous year. This may have been due to an increase in 
#in the price of passes to enter the park, since the annual visitors haven't been close to as high since then.
